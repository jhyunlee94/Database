-- 고양이와 개는 몇 마리 있을까
SELECT ANIMAL_TYPE, COUNT(ANIMAL_TYPE) AS "count"
    FROM ANIMAL_INS
    GROUP BY ANIMAL_TYPE
    ORDER BY ANIMAL_TYPE;
   
-- 동명 동물 수 찾기
GROUP BY의 조건은 HAVING 으로

SELECT NAME, COUNT(NAME) AS "COUNT"
    FROM ANIMAL_INS
    WHERE NAME IS NOT NULL
    GROUP BY NAME
    HAVING COUNT(NAME) > 1
    ORDER BY NAME ASC;

-- 입양 사각 구하기(1)
TO_CHAR : DATE 타입을 CHAR 타입으로 변경하는 방법
TO_DATE : CHAR 타입을 DATE 타입으로 변경하는 방법
YYYYMMDDHH24MISS : 년 월 일 시(24시간) 분 초

SELECT TO_CHAR(DATETIME, 'HH24') AS "HOUR", COUNT(*) AS "COUNT"
    FROM ANIMAL_OUTS
    WHERE TO_CHAR(DATETIME, 'HH24') BETWEEN 09 AND 19   
    GROUP BY TO_CHAR(DATETIME, 'HH24')
    ORDER BY TO_CHAR(DATETIME, 'HH24');

-- 입양 사각 구하기(2)

LEVEL : 계층형을 나타내기 위함 START WITH...CONNECT BY로 시작 위치 끝 지정함
LEFT JOIN ~~ ON ~~ : 왼쪽에 데이터를 뽑아야하기에 해당 쿼리 작성

SELECT HOUR, COUNT(AO.DATETIME) AS "COUNT"
    FROM (
            SELECT LEVEL -1 AS HOUR
            FROM DUAL
            CONNECT BY LEVEL <= 24
        ) A LEFT JOIN ANIMAL_OUTS AO
          ON A.HOUR = TO_CHAR(AO.DATETIME, 'HH24')
    GROUP BY HOUR
    ORDER BY HOUR;
    
